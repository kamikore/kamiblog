{"version":3,"sources":["webpack:///./src/views/Editor.vue","webpack:///./src/utils/edit.js","webpack:///./src/views/Editor.vue?1648","webpack:///./src/views/Editor.vue?672f","webpack:///./node_modules/core-js/modules/es.array.concat.js","webpack:///./node_modules/core-js/modules/es.array.join.js","webpack:///./node_modules/core-js/modules/es.array.splice.js"],"names":["class","ref","id","span","type","title","maxlength","placeholder","show-word-limit","dialogVisible","checkList","length","buttonList","item","index","key","icon","handleClick","text","convertText","wordCount","column","width","footer","tags","showTags","tag","max","tagList","label","mark","element","console","log","selectionEnd","value","splice","selectionStart","join","codeBlock","block","setCursorPosition","elem","val","len","setTimeout","focus","setSelectionRange","range","createTextRange","moveStart","moveEnd","select","hljs","marked","window","onresize","bodyHeight","document","body","clientHeight","textarea","querySelector","tabBar","navgationBar","statPanel","style","height","data","html","isSave","draftID","Object","freeze","isScroll","computed","watch","$route","handler","this","$api","user","updateEditTemp","content","userInfo","_id","$store","dispatch","editTemp","methods","breaks","getElementById","innerHTML","highlightAll","markdownHtml","$loading","fullscreen","article","updateDraft","then","$message","success","close","catch","publishRequest","uid","res","warning","trim","status","err","tagItems","mounted","addEventListener","e","returnValue","location","pathname","$router","push","markdown","rate","Math","ceil","scrollHeight","scrollTop","event","navigator","permissions","query","name","result","state","clipboard","read","i","types","includes","getType","blob","fileName","Date","reader","FileReader","readAsDataURL","onload","uploadImg","imgFile","split","markdown_image","url","render","$","fails","isArray","isObject","toObject","toLength","createProperty","arraySpeciesCreate","arrayMethodHasSpeciesSupport","wellKnownSymbol","V8_VERSION","IS_CONCAT_SPREADABLE","MAX_SAFE_INTEGER","MAXIMUM_ALLOWED_INDEX_EXCEEDED","IS_CONCAT_SPREADABLE_SUPPORT","array","concat","SPECIES_SUPPORT","isConcatSpreadable","O","spreadable","undefined","FORCED","target","proto","forced","arg","k","E","A","n","arguments","TypeError","IndexedObject","toIndexedObject","arrayMethodIsStrict","nativeJoin","ES3_STRINGS","STRICT_METHOD","separator","call","toAbsoluteIndex","toInteger","HAS_SPECIES_SUPPORT","min","MAXIMUM_ALLOWED_LENGTH_EXCEEDED","start","deleteCount","insertCount","actualDeleteCount","from","to","actualStart","argumentsLength"],"mappings":"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","file":"js/chunk-4493ec82.bd3a7dff.js","sourcesContent":["<template>\r\n  <div class=\"editor-container\" ref=\"text\">\r\n    <!-- bootstrap 的栅格系统 -->\r\n    <el-row>\r\n      <el-col :span=\"24\">\r\n        <div class=\"navgation-bar\">\r\n          <div class=\"navgation-bar_title\">\r\n            <el-input\r\n              type=\"text\"\r\n              v-model=\"title\"\r\n              maxlength=\"100\"\r\n              placeholder=\" 请输入文章标题（5~100个字）\"\r\n              show-word-limit\r\n            />\r\n            <el-button @click=\"dialogVisible = true\">\r\n              标签选择\r\n              <i>{{ checkList.length }}</i>\r\n            </el-button>\r\n          </div>\r\n          <div class=\"navgation-bar_buttonWrap\">\r\n            <div\r\n              class=\"navgation-bar_buttonBox\"\r\n              v-for=\"(item, index) in buttonList\"\r\n              :key=\"item.id\"\r\n            >\r\n              <el-button\r\n                class=\"navgation-bar_button iconfont\"\r\n                :class=\"item.icon\"\r\n                @click.native=\"handleClick(index)\"\r\n              >\r\n                {{ item.text }}\r\n              </el-button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </el-col>\r\n    </el-row>\r\n    <el-row>\r\n      <el-col :span=\"12\">\r\n        <el-input\r\n          type=\"textarea\"\r\n          v-model=\"text\"\r\n          @input=\"convertText\"\r\n          ref=\"test\"\r\n        ></el-input>\r\n      </el-col>\r\n      <el-col :span=\"12\">\r\n        <div class=\"markdown-body\" id=\"html\"></div>\r\n      </el-col>\r\n    </el-row>\r\n    <el-row>\r\n      <el-col :span=\"24\">\r\n        <div class=\"stat-panel\">\r\n          <span>Markdown</span>\r\n          <span>{{ this.wordCount }} 字数</span>\r\n          <span>{{ this.column }} 行数</span>\r\n        </div>\r\n      </el-col>\r\n    </el-row>\r\n\r\n    <el-dialog v-model=\"dialogVisible\" title=\"文章标题选择\" width=\"30%\">\r\n      <div class=\"tabList\">\r\n        <div v-for=\"item in tags\" :key=\"item.id\" @click=\"showTags(item)\">\r\n          {{ item.tag }}\r\n        </div>\r\n      </div>\r\n      <el-checkbox-group v-model=\"checkList\" :max=\"5\">\r\n        <el-checkbox\r\n          v-for=\"item in tagList\"\r\n          :key=\"item.id\"\r\n          :label=\"item\"\r\n        ></el-checkbox>\r\n      </el-checkbox-group>\r\n      <template #footer>\r\n        <span>最多可选择5个标签 ！！</span>\r\n        <span class=\"dialog-footer\">\r\n          <el-button @click=\"dialogVisible = false\">Cancel</el-button>\r\n          <el-button type=\"primary\" @click=\"dialogVisible = false\"\r\n            >Confirm</el-button\r\n          >\r\n        </span>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from \"vuex\";\r\n// 引入编辑器工具栏 工具函数\r\nimport { mark, codeBlock } from \"@/utils/edit\";\r\nimport { dataTime } from \"@/utils/date\";\r\nconst hljs = require(\"highlight.js\");\r\nconst marked = require(\"marked\");\r\n\r\n// 原生事件 ，事件在浏览器窗口被调整大小时发生, 在mounted 时就立即触发一次\r\nwindow.onresize = () => {\r\n  const bodyHeight = document.body.clientHeight;\r\n  const textarea = document.querySelector(\".el-row:nth-child(2)\");\r\n  const tabBar = document.querySelector(\".tab-bar\").clientHeight;\r\n  const navgationBar =\r\n    document.querySelector(\".navgation-bar\").clientHeight || \"\";\r\n  const statPanel = document.querySelector(\".stat-panel\").clientHeight;\r\n  textarea.style.height = `${bodyHeight - tabBar - navgationBar - statPanel}px`;\r\n};\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      html: \"\",\r\n      text: ` Marked - Markdown Parser\r\n========================\r\n\r\n[Marked] lets you convert [Markdown] into HTML.  Markdown is a simple text format whose goal is to be very easy to read and write, even when not converted to HTML.  This demo page will let you type anything you like and see how it gets converted.  Live.  No more waiting around.\r\n\r\nHow To Use The Demo\r\n-------------------\r\n\r\n1. Type in stuff on the left.\r\n2. See the live updates on the right.\r\n\r\nThat's it.  Pretty simple.  There's also a drop-down option in the upper right to switch between various views:\r\n\r\n- **Preview:**  A live display of the generated HTML as it would render in a browser.\r\n- **HTML Source:**  The generated HTML before your browser makes it pretty.\r\n- **Lexer Data:**  What [marked] uses internally, in case you like gory stuff like this.\r\n- **Quick Reference:**  A brief run-down of how to format things using markdown.\r\n\r\nWhy Markdown?\r\n-------------\r\n\r\nIt's easy.  It's not overly bloated, unlike HTML.  Also, as the creator of [markdown] says,\r\n\r\n> The overriding design goal for Markdown's\r\n> formatting syntax is to make it as readable\r\n> as possible. The idea is that a\r\n> Markdown-formatted document should be\r\n> publishable as-is, as plain text, without\r\n> looking like it's been marked up with tags\r\n> or formatting instructions.\r\n\r\nReady to start writing?  Either start changing stuff on the left or\r\n[clear everything](/demo/?text=) with a simple click.\r\n\r\n[Marked]: https://github.com/markedjs/marked/\r\n[Markdown]: http://daringfireball.net/projects/markdown/`,\r\n      title: \"\",\r\n      // 文章是否已保存,默认是未编辑所以是true\r\n      isSave: true,\r\n      // 当保存至草稿箱，后续的保存都是对该文章的update\r\n      draftID: null,\r\n      checkList: [],\r\n      tagList: [],\r\n      dialogVisible: false,\r\n      wordCount: \"0\",\r\n      column: \"0\",\r\n      buttonList: Object.freeze([\r\n        { text: \"标记\", icon: \"icon-Marker\" },\r\n        { text: \"插入代码块\", icon: \"icon-code\" },\r\n        { text: \"存至草稿箱\", icon: \"icon-edit\" },\r\n        { text: \"发表\", icon: \"icon-publish\" },\r\n      ]),\r\n      isScroll: true,\r\n    };\r\n  },\r\n  computed: {\r\n    ...mapGetters([\"tags\", \"userInfo\"]),\r\n  },\r\n  watch: {\r\n    $route: {\r\n      handler: function () {\r\n        if (!this.isSave) {\r\n          this.$api.user.updateEditTemp(\r\n            { content: this.text },\r\n            this.userInfo._id\r\n          );\r\n        }\r\n        // 注意凡是修改 vuex 都要调用 mutations\r\n        this.$store.dispatch(\"change_userInfoTemp\", this.text);\r\n      },\r\n    },\r\n    userInfo() {\r\n      this.text = this.userInfo.editTemp;\r\n    },\r\n  },\r\n  methods: {\r\n    convertText() {\r\n      this.wordCount = this.text.length;\r\n      this.html = marked(this.text, { breaks: true }); // 扩展选项\r\n      document.getElementById(\"html\").innerHTML = this.html;\r\n      if (this.isSave) {\r\n        this.isSave = false;\r\n      }\r\n      hljs.highlightAll();\r\n    },\r\n    handleClick(index) {\r\n      const markdownHtml = document.getElementById(\"html\").innerHTML;\r\n      const textarea = document.querySelector(\".el-textarea__inner\");\r\n      switch (index) {\r\n        case 0:\r\n          if (textarea.selectionStart != textarea.selectionEnd) {\r\n            this.text = mark(textarea);\r\n          }\r\n          this.convertText();\r\n          break;\r\n\r\n        case 1:\r\n          this.text = codeBlock(textarea);\r\n          this.convertText();\r\n          break;\r\n\r\n        case 2:\r\n          this.isSave = true;\r\n          this.$loading({ fullscreen: true });\r\n          this.$api.user.updateEditTemp({ content: null }, this.userInfo._id);\r\n          this.userInfo.editTemp = null;\r\n          if (!this.draftID) {\r\n            // 真正的创建草稿箱文章\r\n            this.$api.article\r\n              .publishRequest({\r\n                content: this.text,\r\n                uid: this.userInfo._id,\r\n                title: this.title || \" \",\r\n                tags: this.checkList,\r\n              })\r\n              .then((res) => {\r\n                this.$message.success(\r\n                  \"已保存到草稿箱，可转到后台管理页面查看个人文章 !!!\"\r\n                );\r\n                this.draftID = res.data._id;\r\n                this.$loading().close();\r\n              })\r\n              .catch(() => {\r\n                this.$loading().close();\r\n              });\r\n          } else {\r\n            // 更新草稿箱文章\r\n            this.$api.article\r\n              .updateDraft(\r\n                {\r\n                  content: this.text,\r\n                  title: this.title,\r\n                  tags: this.checkList,\r\n                },\r\n                this.draftID\r\n              )\r\n              .then(() => {\r\n                this.$message.success(\r\n                  \"已保存到草稿箱，可转到后台管理页面查看个人文章 !!!\"\r\n                );\r\n                this.$loading().close();\r\n              })\r\n              .catch(() => {\r\n                this.$loading().close();\r\n              });\r\n          }\r\n          break;\r\n\r\n        case 3:\r\n          if (!this.title) {\r\n            this.$message.warning(\" 文章的标题不能为空 ！！！\");\r\n            break;\r\n          } else if (this.title.length < 5) {\r\n            this.$message.warning(\" 文章的标题不能少于5个字符 ！！！\");\r\n            break;\r\n          } else if (!markdownHtml.trim()) {\r\n            this.$message.warning(\"文章内容不能为空 ！！！\");\r\n            break;\r\n          } else if (!this.checkList.length > 0) {\r\n            this.$message.warning(\"文章的标签不能为空 ！！！\");\r\n            break;\r\n          }\r\n          this.$loading({ fullscreen: true });\r\n          this.$api.article\r\n            .publishRequest({\r\n              content: this.text,\r\n              uid: this.userInfo._id,\r\n              title: this.title,\r\n              tags: this.checkList,\r\n              status: \"published\",\r\n            })\r\n            .then(() => {\r\n              this.$message.success(\"发表成功 !!!\");\r\n              this.$loading().close();\r\n            })\r\n            .catch((err) => {\r\n              this.$loading().close();\r\n            });\r\n          break;\r\n      }\r\n    },\r\n    showTags(item) {\r\n      this.tagList = item.tagItems;\r\n    },\r\n  },\r\n  mounted() {\r\n    window.onresize();\r\n    window.addEventListener(\"beforeunload\", (e) => {\r\n      // 未保存至草稿箱或是书写内容更新都会弹窗，每次修改就把保存状态设 false\r\n      if (!this.isSave) {\r\n        e.returnValue = false;\r\n        if (location.pathname != \"/edit\") {\r\n          this.$router.push(\"/edit\");\r\n        }\r\n      }\r\n      this.$api.user.updateEditTemp({ content: this.text }, this.userInfo._id);\r\n    });\r\n\r\n    // 编辑器的联动滚动，由于双方高度的不同需要有比例的关系，并能够平稳滚动\r\n    const textarea = document.querySelector(\".el-textarea__inner\");\r\n    const markdown = document.querySelector(\".markdown-body\");\r\n\r\n    textarea.addEventListener(\"mousewheel\", () => {\r\n      const rate = Math.ceil(markdown.scrollHeight / textarea.scrollHeight); // 注意顺序 大：小并向上取整\r\n      markdown.scrollTop = textarea.scrollTop * rate;\r\n    });\r\n    markdown.addEventListener(\"mousewheel\", () => {\r\n      const rate = textarea.scrollHeight / markdown.scrollHeight; // 小：大\r\n      textarea.scrollTop = markdown.scrollTop * rate;\r\n    });\r\n\r\n    // 剪贴图片\r\n    textarea.addEventListener(\"paste\", (event) => {\r\n      navigator.permissions.query({ name: \"clipboard-read\" }).then((result) => {\r\n        if (result.state == \"granted\" || result.state == \"prompt\") {\r\n          navigator.clipboard.read().then((data) => {\r\n            for (let i = 0; i < data.length; i++) {\r\n              if (data[i].types.includes(\"image/png\")) {\r\n                data[i].getType(\"image/png\").then((blob) => {\r\n                  let fileName = `image-${dataTime(new Date())}`;\r\n                  let reader = new FileReader();\r\n                  reader.readAsDataURL(blob);\r\n                  reader.onload = () => {\r\n                    this.$api.article\r\n                      .uploadImg({\r\n                        uid: this.userInfo._id,\r\n                        fileName,\r\n                        imgFile: reader.result,\r\n                        type: blob.type.split(\"/\")[1],\r\n                      })\r\n                      .then((res) => {\r\n                        const text = [...textarea.value];\r\n                        const markdown_image = `![${fileName}](${res.data.url})\\n`;\r\n                        //在光标位置插入 image markdown语法\r\n                        text.splice(textarea.selectionStart, 0, markdown_image);\r\n                        this.text = text.join(\"\");\r\n                        this.convertText();\r\n                      });\r\n                  };\r\n                });\r\n              }\r\n            }\r\n          });\r\n        }\r\n      });\r\n    });\r\n\r\n    this.convertText();\r\n    this.isSave = false;\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang='less'>\r\n.placeholder {\r\n  height: 75px;\r\n  line-height: 75px;\r\n}\r\n\r\nbody {\r\n  top: 0;\r\n  bottom: 0;\r\n  right: 0;\r\n  left: 0;\r\n\r\n  // textarea 文本域高度具体由js 计算\r\n  .editor-container {\r\n    display: flex;\r\n    flex-direction: column;\r\n    height: 100%;\r\n\r\n    // el-button 会有自己边界大小，会导致计算textarea 高度偏差\r\n    // .el-row:nth-child(1) {\r\n    //   height: 40px;\r\n    // }\r\n\r\n    .el-row:nth-child(2) {\r\n      .el-col {\r\n        height: 100%;\r\n      }\r\n    }\r\n\r\n    .el-row:nth-child(3) {\r\n      height: 20px;\r\n    }\r\n\r\n    .navgation-bar {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      height: 100%;\r\n\r\n      .navgation-bar_title {\r\n        display: flex;\r\n        flex: 1;\r\n\r\n        .el-input__inner {\r\n          height: 100%;\r\n        }\r\n\r\n        button {\r\n          position: relative;\r\n\r\n          i {\r\n            position: absolute;\r\n            top: 0;\r\n            right: 0;\r\n            width: 18px;\r\n            height: 18px;\r\n            line-height: 18px;\r\n            border-radius: 9px;\r\n            color: #c0c4cc;\r\n            font-style: normal;\r\n            background: #6b6b6b;\r\n          }\r\n        }\r\n      }\r\n\r\n      .navgation-bar_buttonWrap {\r\n        display: flex;\r\n\r\n        .navgation-bar_buttonBox {\r\n          display: flex;\r\n          flex-direction: column;\r\n          height: 100%;\r\n        }\r\n\r\n        .navgation-bar_button {\r\n          height: 100%;\r\n        }\r\n      }\r\n    }\r\n\r\n    .markdown-body {\r\n      height: 100%;\r\n      box-sizing: border-box;\r\n      margin: 0 auto;\r\n      padding: 45px;\r\n      overflow: auto;\r\n      background: #fff;\r\n    }\r\n\r\n    .el-textarea__inner:focus {\r\n      border: 1px solid #c0c4cc;\r\n    }\r\n\r\n    .el-textarea {\r\n      height: 100%;\r\n      background: #f5f5f5;\r\n\r\n      .el-textarea__inner {\r\n        resize: none;\r\n        height: 100%;\r\n        background: #f5f5f5;\r\n      }\r\n    }\r\n\r\n    .stat-panel {\r\n      height: 100%;\r\n      display: flex;\r\n      gap: 10px;\r\n      background: #6b6b6b;\r\n      color: #fff;\r\n      font: 14px \"Helvetica\";\r\n    }\r\n\r\n    .el-dialog {\r\n      min-width: 400px;\r\n\r\n      .el-dialog__body {\r\n        display: flex;\r\n        justify-content: space-between;\r\n        gap: 10px;\r\n\r\n        .tabList {\r\n          display: flex;\r\n          flex-direction: column;\r\n          gap: 10px;\r\n          height: 150px;\r\n          min-width: 100px;\r\n          overflow: auto;\r\n          cursor: pointer;\r\n\r\n          div:hover {\r\n            background: #e0e0e0d0;\r\n          }\r\n          div {\r\n            height: 2rem;\r\n            line-height: 2rem;\r\n            flex: 1;\r\n            white-space: nowrap;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  @media (max-width: 767px) {\r\n    .markdown-body {\r\n      padding: 15px;\r\n    }\r\n  }\r\n}\r\n</style>","\r\n\r\nexport function mark(element) {\r\n    console.log(element.selectionEnd)\r\n    const text = [...element.value];\r\n    text.splice(element.selectionStart, 0, \"<mark>\");\r\n    text.splice(element.selectionEnd+1, 0, \"</mark>\");\r\n    return text.join(\"\");\r\n}\r\n\r\nexport function codeBlock(element) {\r\n    const text = [...element.value];\r\n    const block = \"\\n```\\n\\n```\\n\";\r\n    text.splice(element.selectionStart,0, block)\r\n    // 光标位置，测得 插入位置，与代码块中的位置，相差5\r\n    setCursorPosition(element,element.selectionStart+5)\r\n    return text.join(\"\");\r\n\r\n}\r\n\r\nfunction setCursorPosition(elem, index) {\r\n    var val = elem.value\r\n    var len = val.length\r\n \r\n    // 超过文本长度直接返回\r\n    if (len < index) return\r\n    setTimeout(function() {\r\n        elem.focus()\r\n        if (elem.setSelectionRange) { // 标准浏览器\r\n            elem.setSelectionRange(index, index)   \r\n        } else { // IE9-\r\n            var range = elem.createTextRange()\r\n            range.moveStart(\"character\", -len)\r\n            range.moveEnd(\"character\", -len)\r\n            range.moveStart(\"character\", index)\r\n            range.moveEnd(\"character\", 0)\r\n            range.select()\r\n        }\r\n    }, 10)\r\n}\r\n\r\n\r\n","import { render } from \"./Editor.vue?vue&type=template&id=76520803\"\nimport script from \"./Editor.vue?vue&type=script&lang=js\"\nexport * from \"./Editor.vue?vue&type=script&lang=js\"\n\nimport \"./Editor.vue?vue&type=style&index=0&id=76520803&lang=less\"\nscript.render = render\n\nexport default script","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Editor.vue?vue&type=style&index=0&id=76520803&lang=less\"","'use strict';\nvar $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar isArray = require('../internals/is-array');\nvar isObject = require('../internals/is-object');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar createProperty = require('../internals/create-property');\nvar arraySpeciesCreate = require('../internals/array-species-create');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar V8_VERSION = require('../internals/engine-v8-version');\n\nvar IS_CONCAT_SPREADABLE = wellKnownSymbol('isConcatSpreadable');\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF;\nvar MAXIMUM_ALLOWED_INDEX_EXCEEDED = 'Maximum allowed index exceeded';\n\n// We can't use this feature detection in V8 since it causes\n// deoptimization and serious performance degradation\n// https://github.com/zloirock/core-js/issues/679\nvar IS_CONCAT_SPREADABLE_SUPPORT = V8_VERSION >= 51 || !fails(function () {\n  var array = [];\n  array[IS_CONCAT_SPREADABLE] = false;\n  return array.concat()[0] !== array;\n});\n\nvar SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('concat');\n\nvar isConcatSpreadable = function (O) {\n  if (!isObject(O)) return false;\n  var spreadable = O[IS_CONCAT_SPREADABLE];\n  return spreadable !== undefined ? !!spreadable : isArray(O);\n};\n\nvar FORCED = !IS_CONCAT_SPREADABLE_SUPPORT || !SPECIES_SUPPORT;\n\n// `Array.prototype.concat` method\n// https://tc39.es/ecma262/#sec-array.prototype.concat\n// with adding support of @@isConcatSpreadable and @@species\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  // eslint-disable-next-line no-unused-vars -- required for `.length`\n  concat: function concat(arg) {\n    var O = toObject(this);\n    var A = arraySpeciesCreate(O, 0);\n    var n = 0;\n    var i, k, length, len, E;\n    for (i = -1, length = arguments.length; i < length; i++) {\n      E = i === -1 ? O : arguments[i];\n      if (isConcatSpreadable(E)) {\n        len = toLength(E.length);\n        if (n + len > MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);\n        for (k = 0; k < len; k++, n++) if (k in E) createProperty(A, n, E[k]);\n      } else {\n        if (n >= MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);\n        createProperty(A, n++, E);\n      }\n    }\n    A.length = n;\n    return A;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IndexedObject = require('../internals/indexed-object');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\n\nvar nativeJoin = [].join;\n\nvar ES3_STRINGS = IndexedObject != Object;\nvar STRICT_METHOD = arrayMethodIsStrict('join', ',');\n\n// `Array.prototype.join` method\n// https://tc39.es/ecma262/#sec-array.prototype.join\n$({ target: 'Array', proto: true, forced: ES3_STRINGS || !STRICT_METHOD }, {\n  join: function join(separator) {\n    return nativeJoin.call(toIndexedObject(this), separator === undefined ? ',' : separator);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar toInteger = require('../internals/to-integer');\nvar toLength = require('../internals/to-length');\nvar toObject = require('../internals/to-object');\nvar arraySpeciesCreate = require('../internals/array-species-create');\nvar createProperty = require('../internals/create-property');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('splice');\n\nvar max = Math.max;\nvar min = Math.min;\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF;\nvar MAXIMUM_ALLOWED_LENGTH_EXCEEDED = 'Maximum allowed length exceeded';\n\n// `Array.prototype.splice` method\n// https://tc39.es/ecma262/#sec-array.prototype.splice\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  splice: function splice(start, deleteCount /* , ...items */) {\n    var O = toObject(this);\n    var len = toLength(O.length);\n    var actualStart = toAbsoluteIndex(start, len);\n    var argumentsLength = arguments.length;\n    var insertCount, actualDeleteCount, A, k, from, to;\n    if (argumentsLength === 0) {\n      insertCount = actualDeleteCount = 0;\n    } else if (argumentsLength === 1) {\n      insertCount = 0;\n      actualDeleteCount = len - actualStart;\n    } else {\n      insertCount = argumentsLength - 2;\n      actualDeleteCount = min(max(toInteger(deleteCount), 0), len - actualStart);\n    }\n    if (len + insertCount - actualDeleteCount > MAX_SAFE_INTEGER) {\n      throw TypeError(MAXIMUM_ALLOWED_LENGTH_EXCEEDED);\n    }\n    A = arraySpeciesCreate(O, actualDeleteCount);\n    for (k = 0; k < actualDeleteCount; k++) {\n      from = actualStart + k;\n      if (from in O) createProperty(A, k, O[from]);\n    }\n    A.length = actualDeleteCount;\n    if (insertCount < actualDeleteCount) {\n      for (k = actualStart; k < len - actualDeleteCount; k++) {\n        from = k + actualDeleteCount;\n        to = k + insertCount;\n        if (from in O) O[to] = O[from];\n        else delete O[to];\n      }\n      for (k = len; k > len - actualDeleteCount + insertCount; k--) delete O[k - 1];\n    } else if (insertCount > actualDeleteCount) {\n      for (k = len - actualDeleteCount; k > actualStart; k--) {\n        from = k + actualDeleteCount - 1;\n        to = k + insertCount - 1;\n        if (from in O) O[to] = O[from];\n        else delete O[to];\n      }\n    }\n    for (k = 0; k < insertCount; k++) {\n      O[k + actualStart] = arguments[k + 2];\n    }\n    O.length = len - actualDeleteCount + insertCount;\n    return A;\n  }\n});\n"],"sourceRoot":""}